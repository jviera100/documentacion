# Informe de An√°lisis de Seguridad y Validaci√≥n de Vulnerabilidades con Pruebas Controladas

## üß∞ 1. Configuraci√≥n del Entorno de Pruebas

Para la ejecuci√≥n de este an√°lisis, se sigui√≥ un procedimiento estructurado para establecer un laboratorio virtual controlado. La configuraci√≥n manual de la red es un paso previo y crucial para garantizar la estabilidad y reproducibilidad de los hallazgos.

### 1.1. Despliegue Inicial de M√°quinas Virtuales

1. **Instalaci√≥n**: Se despleg√≥ una m√°quina virtual con Metasploitable 2 como sistema objetivo y Kali Linux como sistema atacante en Oracle VirtualBox.
2. **Primer Inicio y Cierre**: Se realiz√≥ un primer inicio de sesi√≥n en Metasploitable para confirmar su operatividad y posteriormente se apag√≥ la VM para proceder con la configuraci√≥n de red.

### 1.2. Configuraci√≥n de Red Aislada y Est√°tica

1. **Creaci√≥n de Red**: Se cre√≥ una "Red NAT personalizada" denominada `pentesting` a trav√©s de las herramientas de red de VirtualBox.

2. **Desactivaci√≥n del Servidor DHCP**: Se deshabilit√≥ expl√≠citamente el servidor DHCP de la red `pentesting`.
   > ‚ö†Ô∏è **Advertencia**: Este paso es fundamental. Si el DHCP permanece activo, el sistema operativo intentar√° obtener una direcci√≥n IP autom√°ticamente, interfiriendo y sobreescribiendo cualquier configuraci√≥n manual, lo que impide establecer una IP est√°tica de forma fiable.

3. **Conexi√≥n de VMs a la Red**: Ambas m√°quinas virtuales (Kali y Metasploitable) fueron configuradas para conectarse a la red `pentesting`.

### 1.3. Asignaci√≥n Manual de Direcciones IP

#### Configuraci√≥n de la M√°quina Objetivo (Metasploitable)
- Se inici√≥ la VM y se asign√≥ la direcci√≥n IP est√°tica requerida.
- **Comando**: `sudo ip addr add 192.168.1.150/24 dev eth0`
- **Verificaci√≥n Interna**: Se ejecut√≥ `ip a` en Metasploitable para confirmar que la IP fue asignada correctamente.

#### Configuraci√≥n de la M√°quina Atacante (Kali Linux)
- Se inici√≥ la VM y se asign√≥ una direcci√≥n IP est√°tica dentro del mismo segmento de red.
- **Comando**: `sudo ip addr add 192.168.1.100/24 dev eth0`
- **Verificaci√≥n Interna**: Se ejecut√≥ `ip a show eth0` para confirmar la asignaci√≥n en Kali.

### 1.4. Verificaci√≥n de Conectividad del Entorno

Finalmente, se valid√≥ la comunicaci√≥n entre ambas m√°quinas desde Kali Linux, confirmando que el laboratorio est√° listo.
- **Comando**: `ping 192.168.1.150`

### Aseguramiento del Servicio Web (HTTP)

Se detect√≥ que el servidor web Apache no se encontraba activo por defecto. Para permitir el an√°lisis de la aplicaci√≥n web, se inici√≥ el servicio manualmente.
- **Comando Ejecutado en el Objetivo**: `sudo apache2ctl start`
- **Respuesta**: `httpd (pid 4594) already running` - significa que ya est√° ejecut√°ndose el servicio

---

## üõ† 2. Instalaci√≥n de Herramientas

Las siguientes herramientas fueron instaladas en el sistema Kali Linux para realizar el an√°lisis:

- **nmap** (escaneo de puertos)
- **sqlmap** (explotaci√≥n de SQLi)
- **dirb** (fuerza bruta de directorios web)
- **whois, nslookup** (an√°lisis de dominio simulado)
- **Opcional**: Metasploit, Nikto, Wireshark (si se desea extender el an√°lisis)

### Comando de Instalaci√≥n

```bash
sudo apt update
sudo apt install -y nmap sqlmap burpsuite dirb whois dnsutils net-tools nikto metasploit-framework arp-scan ftp hydra john hashcat netcat-traditional zmap gobuster enum4linux smbclient seclists
```

---

## ‚úÖ FASES DEL EJERCICIO

### üîç Paso 1 ‚Äì Reconocimiento

**Herramientas**: whois, nslookup, dirb

**Comandos**:
```bash
nslookup 192.168.1.150
whois empresa.local
dirb http://192.168.1.150
```

**Pantallazos recomendados**:
- Resultado de nslookup y whois (simulado)
- Salida del escaneo con dirb mostrando rutas sensibles

### üîé Paso 2 ‚Äì Escaneo de Puertos

**Comando**:
```bash
nmap -sS -sV -T4 -p- 192.168.1.150 -oN nmap_scan.txt
```

**Pantallazo recomendado**: Parte del archivo `nmap_scan.txt` mostrando puertos abiertos

### üìö Paso 3 ‚Äì B√∫squeda de Vulnerabilidades

Revisar CVEs en:
- [https://cve.mitre.org/](https://cve.mitre.org/)
- [https://exploit-db.com](https://exploit-db.com)

**Referencias espec√≠ficas**:
- [CVE relacionados a MySQL](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=mysql)
- [Exploit espec√≠fico](https://www.exploit-db.com/exploits/19092)

**Pantallazo sugerido**: Captura de CVE relacionado a Apache/MySQL/SQLi

### üí£ Paso 4 ‚Äì Simulaci√≥n de Explotaci√≥n

**Comando**:
```bash
sqlmap -u "http://192.168.1.150/products.php?id=1" --dbs --batch
```

**Pantallazo sugerido**: Consola mostrando bases de datos descubiertas por sqlmap

### üßæ Paso 5 ‚Äì Reporte y Recomendaciones

**Pantallazo sugerido**: Parte del informe y consola con payload usado

#### Recomendaciones de Seguridad

- **Usar consultas preparadas** (prepared statements)
- **Validar entrada de usuarios** (ej. `is_numeric`)
- **Actualizar Apache, PHP, MySQL** a las versiones m√°s recientes
- **Evitar exposici√≥n p√∫blica de MySQL**

---

## üß† Reflexi√≥n Final

### Dificultades Encontradas
- Validar vulnerabilidades sin da√±ar el sistema objetivo

### Importancia del Proceso
- Documentar clara y profesionalmente los hallazgos para facilitar la remediation

### Gesti√≥n del Riesgo
- Priorizar vulnerabilidades explotables con mayor impacto potencial en el entorno de producci√≥n

---

## Conclusiones

Este ejercicio de pentesting controlado ha demostrado la importancia de seguir una metodolog√≠a estructurada para la identificaci√≥n y validaci√≥n de vulnerabilidades. La configuraci√≥n cuidadosa del entorno de pruebas es fundamental para obtener resultados confiables y reproducibles, mientras que la documentaci√≥n detallada permite una comprensi√≥n clara de los riesgos identificados y las medidas de mitigaci√≥n recomendadas.